<!doctype html>
<html data-wf-page="65a79a36e57b234fb27c6de4" data-wf-site="628488dc7d6e4d0605fa192b">
    <head>
        <meta charset="utf-8" />
        <title>Dự án</title>
        <meta content="This is where we show our Projects to our potential customers" name="description" />
        <meta content="Our-Projects" property="og:title" />
        <meta content="This is where we show our Projects to our potential customers" property="og:description" />
        <meta content="Our-Projects" property="twitter:title" />
        <meta content="This is where we show our Projects to our potential customers" property="twitter:description" />
        <meta property="og:type" content="website" />
        <meta content="summary_large_image" name="twitter:card" />
        <meta content="width=device-width, initial-scale=1" name="viewport" />
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css"
            integrity="sha512-2SwdPD6INVrV/lHTZbO2nodKhrnDdJK9/kg2XD1r9uGqPo1cUbujc+IYdlYdEErWNu69gVcYgdxlmVmzTWnetw=="
            crossorigin="anonymous"
            referrerpolicy="no-referrer"
        />
        <link href="../css/grid.css" rel="stylesheet" type="text/css" />
        <link href="css/doorcreative.webflow.5f061b7e1.min.css" rel="stylesheet" type="text/css" />
        <link href="../css/vibo-styles.css" rel="stylesheet" type="text/css" />
        <link href="../css/repositive.css" rel="stylesheet" type="text/css" />
        <link href="https://fonts.googleapis.com" rel="preconnect" />
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin="anonymous" />
        <script src="js/webfont.js" type="text/javascript"></script>
        <script type="text/javascript">
            WebFont.load({
                google: {
                    families: [
                        'Open Sans:300,300italic,400,400italic,600,600italic,700,700italic,800,800italic',
                        'PT Serif:400,400italic,700,700italic',
                        'Roboto:300,regular,500',
                        'Red Rose:300,regular,500,600,700:latin,latin-ext,vietnamese',
                        'Work Sans:regular,500,600,700:latin,latin-ext,vietnamese',
                        'Work Sans:200,300,regular:latin,vietnamese',
                    ],
                },
            });
        </script>
        <link rel="icon" href="../images/vibo-favicon.jpg" />
    </head>

    <body class="body-6">
        <div class="smooth-wrapper">
            <div id="header-placeholder"></div>

            <div class="grid wide">
                <div class="div_work">
                    <div class="div_work_left">
                        <h1 class="heading-18">Các dự án tiêu biểu</h1>
                    </div>
                    <div class="div_work_right">
                        <p class="paragraph-14">
                            Chúng tôi sẽ làm việc chặt chẽ với bạn và cùng nhau giải quyết chúng theo cách phản ánh tầm
                            nhìn của bạn. Chúng tôi được thúc đẩy bởi một mục tiêu chung: biến ý tưởng của bạn thành
                            hiện thực.
                        </p>
                    </div>
                </div>

                <button id="toggleSort">Mới nhất <i class="fa-solid fa-arrow-down"></i></button>

                <div class="row projects-list" id="projectsList"></div>

                <div class="pagination" id="pagination"></div>
            </div>

            <div id="project-modal" class="modal">
                <div class="modal-content">
                    <div class="title-block">
                        <h2 id="project-title"></h2>
                        <span class="close" onclick="closeModal()">&times;</span>
                    </div>
                    <div class="info-block">
                        <p class="project-info"><strong>Thiết kế:</strong> <span id="project-designer"></span></p>
                        <p class="project-info"><strong>Phạm vi:</strong> <span id="project-scope"></span></p>
                        <p class="project-info"><strong>Năm:</strong> <span id="project-year"></span></p>
                    </div>
                    <div class="project-images" id="project-images"></div>
                </div>
            </div>

            <div id="footer-placeholder"></div>
        </div>

        <script src="js/jquery-3.5.1.min.dc5e7f18c8.js" type="text/javascript" crossorigin="anonymous"></script>
        <script src="js/webflow.d6bb8621.dbc19b3cb6af8391.js" type="text/javascript"></script>
        <script src="../js/header-footer.js" type="text/javascript"></script>

        <script type="text/javascript">
            $(document).ready(function () {
                $('#enscapeframe').on('mouseenter', function () {
                    $(this).focus();
                });
            });
        </script>

        <script>
            const projectsList = document.getElementById('projectsList');
            let projects = {};
            let sortMode = 'reverse';

            const btn = document.getElementById('toggleSort');
            btn.onclick = () => {
                sortMode = sortMode === 'reverse' ? 'normal' : 'reverse';
                btn.innerHTML =
                    sortMode === 'reverse'
                        ? 'Mới nhất <i class="fa-solid fa-arrow-down"></i>'
                        : 'Cũ nhất <i class="fa-solid fa-arrow-down"></i>';
                renderProjects(projects);
                initPagination();
            };

            window.addEventListener('popstate', () => {
                const modal = document.getElementById('project-modal');

                if (modal.style.display === 'flex') {
                    document.body.classList.remove('modal-open');
                    modal.style.display = 'none';
                }
            });

            document.addEventListener('DOMContentLoaded', function () {
                loadProjectData();

                const modal = document.getElementById('project-modal');
                modal.addEventListener('click', function (event) {
                    if (event.target === modal) {
                        closeModal();
                    }
                });
            });

            function displayProjectTitles() {
                const projectTitles = document.querySelectorAll('.project-item');

                projectTitles.forEach((item) => {
                    const key = item.getAttribute('onclick').match(/'([^']+)'/)[1];

                    if (projects[key]) {
                        const imgElement = item.querySelector('img');
                        if (imgElement && projects[key].images && projects[key].images.length > 0) {
                            imgElement.src = projects[key].images[0];
                        }
                    }
                });
            }

            function renderProjects(data) {
                projectsList.innerHTML = '';

                let entries = Object.entries(data);

                if (sortMode === 'reverse') {
                    entries = entries.reverse();
                }

                entries.forEach(([key, project]) => {
                    const a = document.createElement('a');

                    a.href = '#';
                    a.className = 'col l-3 m-4 c-6 project-item';
                    a.onclick = () => openModal(key);

                    a.innerHTML = `
                            <img src="${project.images?.[0] || ''}" alt="${project.title}" />
                            <span class="project-title">${project.title}</span>
                        `;

                    projectsList.appendChild(a);
                });
            }

            function initPagination() {
                const itemsPerPage = 12;
                const pagination = document.getElementById('pagination');

                let currentPage = 1;

                function getList() {
                    return document.querySelectorAll('.project-item');
                }

                function showPage(page) {
                    const list = getList();
                    const totalPages = Math.ceil(list.length / itemsPerPage);

                    currentPage = page;

                    list.forEach((item, index) => {
                        item.style.display =
                            index >= (page - 1) * itemsPerPage && index < page * itemsPerPage ? 'block' : 'none';
                    });

                    renderPagination(totalPages);
                }

                function renderPagination(totalPages) {
                    pagination.innerHTML = '';

                    for (let i = 1; i <= totalPages; i++) {
                        const btn = document.createElement('button');
                        btn.textContent = i;
                        if (i === currentPage) btn.classList.add('active');
                        btn.onclick = () => showPage(i);
                        pagination.appendChild(btn);
                    }
                }

                showPage(1);
            }

            function loadProjectData() {
                fetch('projects.json')
                    .then((response) => response.json())
                    .then((data) => {
                        projects = data;
                        renderProjects(projects);
                        initPagination();
                        displayProjectTitles();
                    })
                    .catch((error) => console.error('Error loading project data:', error));
            }

            function openModal(key) {
                const project = projects[key];
                if (!project) return;

                document.getElementById('project-title').innerText = project.title;
                document.getElementById('project-designer').innerText = project.designer;
                document.getElementById('project-scope').innerText = project.scope;
                document.getElementById('project-year').innerText = project.year;

                const imagesContainer = document.getElementById('project-images');
                imagesContainer.innerHTML = '';
                project.images.forEach((imgSrc) => {
                    let img = document.createElement('img');
                    img.src = imgSrc;
                    imagesContainer.appendChild(img);
                });

                document.body.classList.add('modal-open');
                document.getElementById('project-modal').style.display = 'flex';
                document.querySelector('.modal-content').scrollTop = 0;

                if (!history.state || !history.state.modal) {
                    history.pushState({ modal: true, projectKey: key }, '', '#' + key);
                }
            }

            function closeModal() {
                document.body.classList.remove('modal-open');
                document.getElementById('project-modal').style.display = 'none';

                if (history.state && history.state.modal) {
                    history.back();
                }
            }
        </script>
    </body>
</html>
